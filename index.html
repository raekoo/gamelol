<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sheep Meadow Adventure</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(to bottom, #87CEEB 0%, #98D8C8 100%);
            font-family: 'Press Start 2P', 'Courier New', monospace;
            overflow: hidden;
        }
        
        #game-container {
            position: relative;
            background: #2d2d2d;
            border-radius: 10px;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }
        
        #ui-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            padding: 15px;
            background: linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0) 100%);
            z-index: 10;
            pointer-events: none;
        }
        
        #score-panel {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            text-shadow: 2px 2px 0px #000;
        }
        
        #score {
            font-size: 16px;
            background: rgba(126, 200, 80, 0.9);
            padding: 8px 15px;
            border-radius: 20px;
            border: 3px solid #fff;
        }
        
        #flower-counter {
            display: flex;
            gap: 5px;
        }
        
        .flower-icon {
            width: 24px;
            height: 24px;
            background: #ff69b4;
            border-radius: 50%;
            border: 2px solid #fff;
            position: relative;
            transition: transform 0.3s;
        }
        
        .flower-icon.collected {
            background: #ffd700;
            transform: scale(1.2);
        }
        
        #canvas {
            display: block;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }
        
        #victory-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.95);
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        #victory-content {
            text-align: center;
            max-width: 95vw;
            max-height: 95vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            animation: slideUp 0.6s ease-out;
        }
        
        @keyframes slideUp {
            from { 
                transform: translateY(50px);
                opacity: 0;
            }
            to { 
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        #victory-content h1 {
            color: #ffd700;
            margin-bottom: 20px;
            font-size: 28px;
            text-shadow: 3px 3px 0px #000;
            animation: pulse 2s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        #victory-image {
            max-width: 85vw;
            max-height: 70vh;
            border-radius: 15px;
            border: 5px solid #ffd700;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.6);
            margin: 20px 0;
            object-fit: contain;
        }
        
        #play-again {
            background: linear-gradient(to bottom, #7ec850 0%, #5fa030 100%);
            color: white;
            border: 4px solid #fff;
            padding: 15px 40px;
            font-size: 16px;
            border-radius: 30px;
            cursor: pointer;
            font-family: 'Press Start 2P', 'Courier New', monospace;
            text-shadow: 2px 2px 0px #000;
            margin-top: 20px;
            transition: transform 0.2s, box-shadow 0.2s;
            pointer-events: auto;
        }
        
        #play-again:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(126, 200, 80, 0.8);
        }
        
        #play-again:active {
            transform: scale(0.95);
        }
        
        #instructions {
            position: absolute;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 12px;
            text-shadow: 2px 2px 0px #000;
            background: rgba(0,0,0,0.5);
            padding: 10px 20px;
            border-radius: 20px;
            z-index: 10;
            pointer-events: none;
        }
        
        .sparkle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #fff;
            border-radius: 50%;
            pointer-events: none;
            animation: sparkleFloat 1s ease-out forwards;
        }
        
        @keyframes sparkleFloat {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateY(-50px) scale(0);
                opacity: 0;
            }
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="ui-overlay">
            <div id="score-panel">
                <div id="score">ðŸŒ¸ 0 / 10</div>
                <div id="flower-counter"></div>
            </div>
        </div>
        <canvas id="canvas" width="800" height="600"></canvas>
        <div id="instructions">Arrow Keys / WASD to Move â€¢ Collect All Flowers!</div>
    </div>
    
    <div id="victory-screen">
        <div id="victory-content">
            <h1>ðŸŽ‰ CONGRATULATIONS! ðŸŽ‰</h1>
            <img id="victory-image" src="victory-image.jpg" alt="Victory!">
            <button id="play-again">PLAY AGAIN</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const scoreDisplay = document.getElementById('score');
        const flowerCounter = document.getElementById('flower-counter');
        const victoryScreen = document.getElementById('victory-screen');
        const playAgainBtn = document.getElementById('play-again');
        
        // Game constants
        const TILE_SIZE = 32;
        const WALK_SPEED = 2;
        const ANIMATION_SPEED = 8;
        
        // Game state
        let sheep = {
            x: 400,
            y: 300,
            gridX: 12,
            gridY: 9,
            targetX: 400,
            targetY: 300,
            direction: 'down',
            animFrame: 0,
            animCounter: 0,
            isMoving: false
        };
        
        let flowers = [];
        let flowersCollected = 0;
        const totalFlowers = 10;
        let grass = [];
        let fences = [];
        
        // Keyboard state
        const keys = {};
        let lastDirection = null;
        
        // Create flower icons in UI
        function initFlowerIcons() {
            flowerCounter.innerHTML = '';
            for (let i = 0; i < totalFlowers; i++) {
                const icon = document.createElement('div');
                icon.className = 'flower-icon';
                icon.id = `flower-icon-${i}`;
                flowerCounter.appendChild(icon);
            }
        }
        
        // Initialize game world
        function initWorld() {
            flowers = [];
            grass = [];
            
            // Create grass patches
            for (let i = 0; i < 150; i++) {
                grass.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    type: Math.floor(Math.random() * 3)
                });
            }
            
            // Generate static background
            generateStaticBackground();
            
            // Create flowers in grid-like positions but with variation
            const spacing = 100;
            const offsetX = 100;
            const offsetY = 80;
            
            for (let i = 0; i < totalFlowers; i++) {
                const row = Math.floor(i / 5);
                const col = i % 5;
                flowers.push({
                    x: offsetX + col * spacing + (Math.random() - 0.5) * 40,
                    y: offsetY + row * spacing + (Math.random() - 0.5) * 40,
                    size: 24,
                    collected: false,
                    wobble: Math.random() * Math.PI * 2,
                    wobbleSpeed: 0.02 + Math.random() * 0.02
                });
            }
        }
        
        // Static background elements (generated once)
        let staticBackground = null;
        
        // Generate static background
        function generateStaticBackground() {
            staticBackground = document.createElement('canvas');
            staticBackground.width = canvas.width;
            staticBackground.height = canvas.height;
            const bgCtx = staticBackground.getContext('2d');
            
            // Base grass
            const gradient = bgCtx.createLinearGradient(0, 0, 0, canvas.height);
            gradient.addColorStop(0, '#7ec850');
            gradient.addColorStop(1, '#6ab040');
            bgCtx.fillStyle = gradient;
            bgCtx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Grass patches
            grass.forEach(g => {
                bgCtx.fillStyle = g.type === 0 ? '#6ab040' : g.type === 1 ? '#8dd860' : '#5fa030';
                bgCtx.fillRect(g.x, g.y, 4, 4);
                bgCtx.fillRect(g.x + 2, g.y + 4, 3, 3);
            });
            
            // Draw path/dirt patches
            for (let x = 0; x < canvas.width; x += TILE_SIZE) {
                for (let y = 0; y < canvas.height; y += TILE_SIZE) {
                    if (Math.random() < 0.05) {
                        bgCtx.fillStyle = '#8b6914';
                        bgCtx.fillRect(x, y, TILE_SIZE, TILE_SIZE);
                        bgCtx.fillStyle = '#7a5a10';
                        bgCtx.fillRect(x + 4, y + 4, 6, 6);
                    }
                }
            }
        }
        
        // Draw background with grass
        function drawBackground() {
            if (staticBackground) {
                ctx.drawImage(staticBackground, 0, 0);
            }
        }
        
        // Draw animated sheep (Pokemon trainer style)
        function drawSheep() {
            ctx.save();
            
            const x = sheep.x;
            const y = sheep.y;
            const frame = sheep.animFrame;
            
            // Animation offset for walking
            let legOffset = 0;
            if (sheep.isMoving) {
                legOffset = frame % 2 === 0 ? -2 : 2;
            }
            
            
            // Draw sheep based on direction
            if (sheep.direction === 'down') {
                // Body
                ctx.fillStyle = '#f5f5f5';
                ctx.fillRect(x - 14, y - 6, 28, 20);
                ctx.fillStyle = '#e0e0e0';
                ctx.fillRect(x - 12, y - 4, 24, 16);
                
                // Head
                ctx.fillStyle = '#f0f0f0';
                ctx.fillRect(x - 10, y - 14, 20, 14);
                
                // Ears
                ctx.fillStyle = '#ffb6c1';
                ctx.fillRect(x - 10, y - 12, 4, 4);
                ctx.fillRect(x + 6, y - 12, 4, 4);
                
                // Eyes
                ctx.fillStyle = '#000';
                ctx.fillRect(x - 6, y - 8, 3, 3);
                ctx.fillRect(x + 3, y - 8, 3, 3);
                
                // Nose
                ctx.fillStyle = '#333';
                ctx.fillRect(x - 2, y - 4, 4, 2);
                
                // Legs
                ctx.fillStyle = '#333';
                ctx.fillRect(x - 10, y + 14 + legOffset, 5, 8);
                ctx.fillRect(x + 5, y + 14 - legOffset, 5, 8);
                
            } else if (sheep.direction === 'up') {
                // Body (back view)
                ctx.fillStyle = '#f5f5f5';
                ctx.fillRect(x - 14, y - 6, 28, 20);
                
                // Fluffy texture
                ctx.fillStyle = '#fff';
                ctx.fillRect(x - 10, y - 2, 4, 4);
                ctx.fillRect(x + 6, y + 2, 4, 4);
                ctx.fillRect(x - 2, y + 4, 4, 4);
                
                // Head (back)
                ctx.fillStyle = '#f0f0f0';
                ctx.fillRect(x - 8, y - 12, 16, 10);
                
                // Ears
                ctx.fillStyle = '#ffb6c1';
                ctx.fillRect(x - 8, y - 10, 3, 4);
                ctx.fillRect(x + 5, y - 10, 3, 4);
                
                // Legs
                ctx.fillStyle = '#333';
                ctx.fillRect(x - 10, y + 14 + legOffset, 5, 8);
                ctx.fillRect(x + 5, y + 14 - legOffset, 5, 8);
                
            } else if (sheep.direction === 'left') {
                // Body (side view)
                ctx.fillStyle = '#f5f5f5';
                ctx.fillRect(x - 12, y - 4, 24, 18);
                
                // Fluffy outline
                ctx.fillStyle = '#fff';
                ctx.fillRect(x - 14, y - 2, 4, 4);
                ctx.fillRect(x - 12, y + 4, 4, 4);
                
                // Head
                ctx.fillStyle = '#f0f0f0';
                ctx.fillRect(x - 18, y - 10, 12, 12);
                
                // Ear
                ctx.fillStyle = '#ffb6c1';
                ctx.fillRect(x - 16, y - 8, 3, 4);
                
                // Eye
                ctx.fillStyle = '#000';
                ctx.fillRect(x - 14, y - 6, 3, 3);
                
                // Legs
                ctx.fillStyle = '#333';
                ctx.fillRect(x - 8, y + 14 + legOffset, 4, 8);
                ctx.fillRect(x + 4, y + 14 - legOffset, 4, 8);
                
            } else if (sheep.direction === 'right') {
                // Body (side view)
                ctx.fillStyle = '#f5f5f5';
                ctx.fillRect(x - 12, y - 4, 24, 18);
                
                // Fluffy outline
                ctx.fillStyle = '#fff';
                ctx.fillRect(x + 10, y - 2, 4, 4);
                ctx.fillRect(x + 8, y + 4, 4, 4);
                
                // Head
                ctx.fillStyle = '#f0f0f0';
                ctx.fillRect(x + 6, y - 10, 12, 12);
                
                // Ear
                ctx.fillStyle = '#ffb6c1';
                ctx.fillRect(x + 13, y - 8, 3, 4);
                
                // Eye
                ctx.fillStyle = '#000';
                ctx.fillRect(x + 11, y - 6, 3, 3);
                
                // Legs
                ctx.fillStyle = '#333';
                ctx.fillRect(x - 8, y + 14 + legOffset, 4, 8);
                ctx.fillRect(x + 4, y + 14 - legOffset, 4, 8);
            }
            
            ctx.restore();
        }
        
        // Draw flower with animation
        function drawFlower(flower) {
            if (flower.collected) return;
            
            flower.wobble += flower.wobbleSpeed;
            const wobbleX = Math.sin(flower.wobble) * 2;
            
            const x = flower.x + wobbleX;
            const y = flower.y;
            
            // Shadow
            ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';
            ctx.ellipse(x, y + 12, 8, 3, 0, 0, Math.PI * 2);
            ctx.fill();
            
            // Stem
            ctx.fillStyle = '#2d5016';
            ctx.fillRect(x - 2, y + 4, 4, 12);
            ctx.fillStyle = '#3d6026';
            ctx.fillRect(x - 1, y + 4, 2, 12);
            
            // Leaves
            ctx.fillStyle = '#2d5016';
            ctx.fillRect(x - 6, y + 8, 6, 3);
            ctx.fillRect(x + 2, y + 10, 6, 3);
            
            // Petals (5 petals around center)
            const petalPositions = [
                {x: -8, y: -8}, {x: 6, y: -8},
                {x: -10, y: 2}, {x: 8, y: 2},
                {x: -2, y: -12}
            ];
            
            ctx.fillStyle = '#ff69b4';
            petalPositions.forEach(pos => {
                ctx.fillRect(x + pos.x, y + pos.y, 6, 6);
            });
            
            // Petal highlights
            ctx.fillStyle = '#ff8db4';
            petalPositions.forEach(pos => {
                ctx.fillRect(x + pos.x + 1, y + pos.y + 1, 3, 3);
            });
            
            // Center
            ctx.fillStyle = '#ffff00';
            ctx.fillRect(x - 4, y - 4, 8, 8);
            ctx.fillStyle = '#ffed4e';
            ctx.fillRect(x - 2, y - 2, 4, 4);
            
            // Sparkle
            if (Math.random() < 0.05) {
                ctx.fillStyle = '#fff';
                ctx.fillRect(x + Math.random() * 8 - 4, y - 16, 2, 2);
            }
        }
        
        // Create sparkle effect
        function createSparkle(x, y) {
            for (let i = 0; i < 8; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.style.left = x + 'px';
                sparkle.style.top = y + 'px';
                sparkle.style.animationDelay = (i * 0.05) + 's';
                document.getElementById('game-container').appendChild(sparkle);
                
                setTimeout(() => sparkle.remove(), 1000);
            }
        }
        
        // Check collision
        function checkCollision(flower) {
            const dx = sheep.x - flower.x;
            const dy = sheep.y - flower.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            return distance < 30;
        }
        
        // Handle movement
        function handleMovement() {
            let moving = false;
            let newDirection = null;
            
            if (keys['ArrowUp'] || keys['w'] || keys['W']) {
                sheep.targetY = Math.max(30, sheep.y - WALK_SPEED);
                sheep.y = sheep.targetY;
                newDirection = 'up';
                moving = true;
            }
            if (keys['ArrowDown'] || keys['s'] || keys['S']) {
                sheep.targetY = Math.min(canvas.height - 30, sheep.y + WALK_SPEED);
                sheep.y = sheep.targetY;
                newDirection = 'down';
                moving = true;
            }
            if (keys['ArrowLeft'] || keys['a'] || keys['A']) {
                sheep.targetX = Math.max(30, sheep.x - WALK_SPEED);
                sheep.x = sheep.targetX;
                newDirection = 'left';
                moving = true;
            }
            if (keys['ArrowRight'] || keys['d'] || keys['D']) {
                sheep.targetX = Math.min(canvas.width - 30, sheep.x + WALK_SPEED);
                sheep.x = sheep.targetX;
                newDirection = 'right';
                moving = true;
            }
            
            if (newDirection && newDirection !== lastDirection) {
                sheep.direction = newDirection;
                lastDirection = newDirection;
            }
            
            sheep.isMoving = moving;
            
            // Animate
            if (moving) {
                sheep.animCounter++;
                if (sheep.animCounter >= ANIMATION_SPEED) {
                    sheep.animCounter = 0;
                    sheep.animFrame = (sheep.animFrame + 1) % 2;
                }
            } else {
                sheep.animFrame = 0;
            }
        }
        
        // Update game
        function update() {
            handleMovement();
            
            // Check flower collection
            flowers.forEach((flower, index) => {
                if (!flower.collected && checkCollision(flower)) {
                    flower.collected = true;
                    flowersCollected++;
                    scoreDisplay.textContent = `ðŸŒ¸ ${flowersCollected} / ${totalFlowers}`;
                    
                    // Update UI icon
                    const icon = document.getElementById(`flower-icon-${index}`);
                    if (icon) {
                        icon.classList.add('collected');
                    }
                    
                    // Create sparkle effect
                    const rect = canvas.getBoundingClientRect();
                    createSparkle(rect.left + flower.x, rect.top + flower.y);
                    
                    // Check victory
                    if (flowersCollected === totalFlowers) {
                        setTimeout(() => {
                            victoryScreen.style.display = 'flex';
                        }, 800);
                    }
                }
            });
        }
        
        // Draw game
        function draw() {
            drawBackground();
            
            // Draw all flowers
            flowers.forEach(drawFlower);
            
            // Draw sheep
            drawSheep();
        }
        
        // Game loop
        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }
        
        // Keyboard handlers
        document.addEventListener('keydown', (e) => {
            keys[e.key] = true;
            e.preventDefault();
        });
        
        document.addEventListener('keyup', (e) => {
            keys[e.key] = false;
            e.preventDefault();
        });
        
        // Play again button
        playAgainBtn.addEventListener('click', () => {
            flowersCollected = 0;
            scoreDisplay.textContent = `ðŸŒ¸ 0 / ${totalFlowers}`;
            victoryScreen.style.display = 'none';
            sheep.x = 400;
            sheep.y = 300;
            sheep.direction = 'down';
            sheep.animFrame = 0;
            initWorld();
            initFlowerIcons();
        });
        
        // Start game
        initWorld();
        initFlowerIcons();
        gameLoop();
    </script>
</body>
</html>
